<div class="navbar-secondary" ng-class="{'navbar-secondary-short': dash.scroll > 80}">

    <div class="new-message pull-right" ng-click="messages.toggleMessageShow()">
        <span>{{::messages.strings.ACTION_NEW_MESSAGE}}</span>
        <span><img src="css/img/msj_nuevo.png" alt=""></span>
    </div>
</div>
<div class="row fade in">
  <div class="col-xs-12 col-md-11 col-md-offset-1">
    <div class="row dashboard-messages">
      <div class="col-xs-12 col-md-9 col-md-offset-1 separate-above ">
          <form class="separate-above  ">
              <fieldset>
                  <div class="form-group" >
                      <input type="text" class="form-control" placeholder="{{::messages.strings.SEARCH_PLACEHOLDER}}" ng-model='messages.search'
                             name="search" id="search"> <i class="mdi mdi-action-search"></i></input>
                  </div>
              </fieldset>
          </form>
      </div>
    </div>
    <div class="separate-above dashboard-messages-container col-xs-12 col-md-9 col-md-offset-1" ng-if="messages.messages.length > 0">
        <a ng-repeat="message in messages.messages track by message.id" ui-sref="dash.activities-manage.messages-detail({'messageId': message.id})"  class="row">
            <div class="col-xs-12 row separate-below-less">
                <div class="col-md-8">
                    <span class=" text-dark montserrat-semibold" ng-bind="::message.activity"></span>
                </div>
                <div class="col-md-4 text-right">
                    <span class="text-gray-light montserrat-light" ng-bind="::message.created_at | date: 'dd MMM yyyy'"></span>
                </div>
            </div>
            <div class="col-xs-12 text-dark montserrat-regular">
                <span ng-bind="::message.strings.LABEL_INITIAL_DATE"></span>
                <span ng-bind="::message.initial_date | date: 'dd MMM yyyy'"></span>
            </div>
            <div class="col-xs-12 montserrat-light">
                <p ng-bind="::message.subject"></p>
            </div>
        </a>
    </div>
    <div class="text-center col-xs-10" ng-if="messages.messages.length > 0">
        <pagination class="pagination-sm"
            ng-model="messages.paginationOpts.pageNumber"
            ng-change="messages.pageChange()"
            data-total-items="messages.paginationOpts.totalItems"
            previous-text="{{::messages.strings.PREVIOUS_TEXT}}"
            next-text="{{::messages.strings.NEXT_TEXT}}"
            data-items-per-page="messages.paginationOpts.itemsPerPage"></pagination>
    </div>
    <div ng-if="messages.messages.length === 0">
      <div class="col-xs-10 col-xs-offset-1 col-md-8 col-md-offset-2 text-center separate-above">
          <img src="css/img/organizer_dashboard_activities_empty.png"
              alt="{{messages.strings.COPY_NO_MESSAGES}}"
              class="center-block img-responsive"/>
          <p class="separate-below separate-above font-family-sans-alt text-muted"
                ng-bind="::messages.strings.COPY_NO_MESSAGES">
          </p>
          <a class="btn btn-lg btn-success margin-horizontal-less"
             ng-click="messages.toggleMessageShow()"
             ng-bind="::messages.strings.ACTION_NEW_MESSAGE"></a>
      </div>
    </div>
  </div>
</div>

<div class="absolute-container" ng-show="messages.showMessage">
  <button class="pull-right absolute-container__close" ng-click="messages.toggleMessageShow()">
    <img class="img-responsive" src="/css/img/activity-enroll/close.png" alt=""/>
  </button>
  <div class="col-xs-12 col-md-7">
    <div class="modal-content modal-email">
      <div class="modal-header">
        <div class="well-title">
          <h3 class="text-center" ng-bind="::detail.strings.EMAIL_MODAL_HEADER">
          </h3>
        </div>
      </div>
      <div class="modal-body">
        <form name='detail.email_form' ng-submit="messages.submitMessage()" class="separate-above separate-below-less form-classic">
          <fieldset>
              <div class="separate-above" trulii-input-errors-control="calendar">
                  <label for="calendar-select" class="sr-only"
                         ng-bind="::messages.strings.LABEL_CALENDAR"></label>
                  <select id="calendar-select" name="calendar"
                         class="form-control" ng-model="messages.message.calendar"
                         ng-options="calendar as (calendar.initial_date | date: 'dd MMM yyyy') for calendar in messages.calendars track by calendar.id">
                         <option value="" ng-hide="messages.message.calendar"
                                 ng-bind="::messages.strings.OPTION_CALENDAR_DEFAULT" selected>
                         </option>
                  </select>
              </div>
              <div class="separate-above-less" trulii-input-errors-control="subject">
                  <label for="subject-input" ng-bind="::messages.strings.SUBJECT_MESSAGE_PLACEHOLDER">
                </label>
                  <input id="subject-input" class="form-control" name="subject" type="text"
                    ng-model="messages.message.subject"
                    placeholder="{{messages.strings.SUBJECT_MESSAGE_PLACEHOLDER}}" >
              </div>
            <div  trulii-input-errors-control="message">
              <label for="message" ng-bind="detail.strings.EMAIL_MODAL_MESSAGE_LABEL"></label>
              <textarea name="message" id="message" class="form-control"
                        ng-model="messages.message.detail"
                        placeholder="{{messages.strings.MODAL_MESSAGE_PLACEHOLDER}}">
              </textarea>
            </div>
            <div class="form-group" trulii-input-errors-control="__all__">
                <input type="hidden" name="__all__" ng-model="__all__"/>
            </div>

            <div class="form-group">
              <div class="row">
                <div class="col-xs-12 col-sm-4 col-sm-offset-4">
                  <button type="submit" id="submit"
                    class="btn btn-lg btn-success btn-block"
                    ng-bind="::messages.strings.LABEL_SEND_MESSAGE">
                  </button>
                </div>
              </div>
            </div>
          </fieldset>
        </form>
      </div>
    </div>
  </div>
</div>
